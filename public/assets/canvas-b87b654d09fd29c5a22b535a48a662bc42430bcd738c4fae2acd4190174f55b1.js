window.onload=function(){function t(t,o,B,e,x,g,n,A){$.ajax({data:{robot:{a1x:t,a1y:o,a2x:B,a2y:e,a3x:x,a3y:g,a4x:n,a4y:A}},type:"POST",url:"/robots",success:function(){console.log("Successful Push To Server")},error:function(){console.log("Failure to Push To Server")}})}function o(){brushSize=$("#slider").slider("value")}function B(){$.ajax({type:"GET",dataType:"json",url:"/last",success:function(t){console.log(t.a1x),A1=h.circle(t.a1x,t.a1y),A2=h.circle(t.a2x,t.a2y),A3=h.circle(t.a3x,t.a3y),A4=h.circle(t.a4x,t.a4y)}}),A1=h.circle(h.width/2,h.height,1),A1.attr("fill","#f00"),A1.attr("stroke","#fff"),A2=h.circle(A1.attrs.cx,A1.attrs.cy-150,1),A2.attr("fill","#f00"),A2.attr("stroke","#fff"),A3=h.circle(A2.attrs.cx,A2.attrs.cy-100,1),A3.attr("fill","#f00"),A3.attr("stroke","#fff"),A4=h.circle(A3.attrs.cx,A3.attrs.cy-75,1),A4.attr("fill","#111"),A4.attr("stroke","#111")}function e(){L1.remove(),L2.remove(),L3.remove()}function x(){L1_Path="M"+String(A1.getBBox().x+A1.getBBox().width/2)+" "+String(A1.getBBox().y+A1.getBBox().height/2)+"L"+String(A2.getBBox().x+A2.getBBox().width/2)+" "+String(A2.getBBox().y+A2.getBBox().height/2),L1=h.path(L1_Path),L1.attr({stroke:"red"}),L2_Path="M"+String(A2.getBBox().x+A2.getBBox().width/2)+" "+String(A2.getBBox().y+A2.getBBox().height/2)+"L"+String(A3.getBBox().x+A3.getBBox().width/2)+" "+String(A3.getBBox().y+A3.getBBox().height/2),L2=h.path(L2_Path),L2.attr({stroke:"green"}),L3_Path="M"+String(A3.getBBox().x+A3.getBBox().width/2)+" "+String(A3.getBBox().y+A3.getBBox().height/2)+"L"+String(A4.getBBox().x+A4.getBBox().width/2)+" "+String(A4.getBBox().y+A4.getBBox().height/2),L3=h.path(L3_Path),L3.attr({stroke:"blue"})}function g(){A1.transform("...T-5,0"),A2.transform("...T-5,0"),A3.transform("...T-5,0"),A4.transform("...T-5,0"),t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y),y(),e(),x()}function n(){A1.transform("...T5,0"),A2.transform("...T5,0"),A3.transform("...T5,0"),A4.transform("...T5,0"),t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function A(){t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function a(){t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function r(){var o="...R-5,"+A3.getBBox().x+","+A3.getBBox().y;A4.transform(o),t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function i(){var o="...R5,"+A3.getBBox().x+","+A3.getBBox().y;A4.transform(o),t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function c(){A4.transform("t0,-5...");s(A4.getBBox().x,A4.getBBox().y);t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function f(){A4.transform("t0,5...");s(A4.getBBox().x,A4.getBBox().y);t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function l(){A4.transform("t-5,0...");s(A4.getBBox().x,A4.getBBox().y);t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function u(){A4.transform("t5,0...");s(A4.getBBox().x,A4.getBBox().y);t(A1.getBBox().x,A1.getBBox().y,A2.getBBox().x,A2.getBBox().y,A3.getBBox().x,A3.getBBox().y,A4.getBBox().x,A4.getBBox().y)}function y(){1==paint&&(dot=h.circle(A4.getBBox().x,A4.getBBox().y,brushSize),dot.attr("fill",paintColor))}function s(t,o){t=t-h.width/2+1,t=Math.round(t),o=h.height-o-L1.getBBox().height-1,o=Math.round(o),D=Math.pow(L2.getBBox().height,2)+Math.pow(L3.getBBox().height,2)-Math.pow(t,2)-Math.pow(o,2),D/=2*L2.getBBox().height*L3.getBBox().height,console.log(D),temp=Math.sqrt(1-Math.pow(D,2)),e(),x()}window.setInterval(function(){$.ajax({type:"GET",dataType:"json",url:"/last",success:function(t){console.log(t.a1x),A1.getBBox().x=t.a1x,A1.getBBox().y=t.a1y,A2.getBBox().x=t.a2x,A2.getBBox().y=t.a2y,A3.getBBox().x=t.a3x,A3.getBBox().y=t.a3y,A4.getBBox().x=t.a4x,A4.getBBox().y=t.a4y,y(),e(),x()}})},500);var h=Raphael(200,10,1200,400);paint=!1,paintColor="black",B(),x(),$(function(){$("#slider").slider({min:1,max:10,change:function(){o()}})}),o(),$("#moveL1Left").on("click",function(t){t.preventDefault(),g()}),$("#moveL1Right").on("click",function(t){t.preventDefault(),n()}),$("#rotateL2Counter").on("click",function(t){t.preventDefault(),A()}),$("#rotateL2Clockwise").on("click",function(t){t.preventDefault(),a()}),$("#rotateL3Counter").on("click",function(t){t.preventDefault(),r()}),$("#rotateL3Clockwise").on("click",function(t){t.preventDefault(),i()}),$("#brushUpButton").on("click",function(t){t.preventDefault(),c()}),$("#brushDownButton").on("click",function(t){t.preventDefault(),f()}),$("#brushLeftButton").on("click",function(t){t.preventDefault(),l()}),$("#brushRightButton").on("click",function(t){t.preventDefault(),u()}),$("#paintToggleButton").on("click",function(t){t.preventDefault(),0==paint?($(this).find("i").toggleClass("fa-toggle-off fa-toggle-on"),paint=!0):($(this).find("i").toggleClass("fa-toggle-off fa-toggle-on"),paint=!1)}),$("#resetCanvasButton").on("click",function(t){t.preventDefault(),B(),e(),x()})};